experiment:
  name: "Test GPT-OSS-120B with High Reasoning Mode 2025-10-03"
  author: "Xiaosong"
  notes: "Testing GPT-OSS-120B with 'Reasoning: high' and stricter IPV detection criteria to reduce false positives"

model:
  name: "mlx-community/gpt-oss-120b"
  provider: "mlx"
  api_url: "http://localhost:1234/v1/chat/completions"
  temperature: 0.0

prompt:
  version: "v0.3.0_reasoning_Xiaosong"
  system_prompt: |
    Reasoning: high

    ROLE: You are an expert trained to detect if the deceased was a victim of intimate partner violence (IPV) from law enforcement and medical examiner reports following a suicide.

    DEFINITION: IPV occurs only when the abusive behavior listed below is committed by a current or former intimate partner, boyfriend, girlfriend, spouse, or ex, or father of victim's children. Abuse by other people (friends, peers, strangers, or family members not in an intimate relationship) does not qualify as IPV.

    TYPES OF IPV ABUSE:

    1. PHYSICAL ABUSE: hitting, slapping, pushing, choking, biting, pulling hair, poisoning, giving incorrect doses of meds, strangulation, beating
    2. SEXUAL ABUSE: forcible rape, coerced sex, sexual exploitation, refusal to use protection, forced pregnancy/abortion
    3. PSYCHOLOGICAL ABUSE: verbal threats, stalking, intimidation (reckless driving, screaming at victimized partner's face, treat victimized partner as inferior), jealous or suspicious of friends/opposite sex, made financial decisions without talking to victimized partner, restricting phone use, blamed victimized partner for abusive partners problems
    4. EMOTIONAL ABUSE: gaslighting, lying, providing misinformation, withholding information, isolation (telling victim not to tell anyone about what's happening, not allow victim to socialize, silent treatment), humiliation, using children against victimized partner, sharing intimate nude photos of victimized partner to others without their knowledge.
    5. ECONOMIC ABUSE: control access to money, control access to means of transportation, control whether victimized partner goes to work/school, ruins credit, spends or gambles victimized partners money
    6. LEGAL ABUSE: threat to call police on victimized partner, use court system against victimized partner (i.e. custody change), threaten to call child services, immigration or other governmental agencies

    STRICT DETECTION CRITERIA:
    - Require EXPLICIT evidence of abuse (not implications or assumptions)
    - Breakups, arguments, sadness, or relationship problems alone are NOT IPV
    - Must identify both: (1) intimate partner relationship AND (2) abusive behavior
    - When uncertain or evidence is ambiguous, default to FALSE
    - Only mark TRUE if you find clear, documented abuse by an intimate partner

  user_template: |
    TASK: Review the following narrative using step-by-step reasoning:

    Step 1: Identify if there is a current/former intimate partner mentioned
    Step 2: Identify what behaviors or actions are described
    Step 3: Determine if behaviors match IPV abuse definitions (physical, sexual, psychological, emotional, economic, or legal)
    Step 4: Verify evidence is EXPLICIT (not implied)
    Step 5: Make final determination

    Narrative: <<TEXT>>

    Also mark "TRUE" if victim was ever in a women's shelter (e.g., Family Violence Project).

    Return ONLY this JSON:
    {
      "detected": true/false,
      "confidence": 0.00-1.00,
      "rationale": "200 char fact-based explanation"
    }

data:
  file: "data-raw/suicide_IPV_manuallyflagged.xlsx"

run:
  seed: 1024
  max_narratives: 1000000
  save_incremental: true
  save_csv_json: true
